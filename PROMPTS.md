# Development Prompts

This document contains the prompts I used to build this Cloudflare Agents Q&A application.

## Initial Setup and Architecture

I need to build an AI-powered application on Cloudflare that meets specific requirements. The application should use Llama 3.3 on Workers AI as the LLM, implement workflow and coordination using Durable Objects, provide user input via a chat interface with voice support using Web Speech API, and include memory and state management. The application should be a documentation assistant chatbot specifically for Cloudflare Agents SDK that only answers questions about Cloudflare Agents and politely refuses unrelated questions. Set up the project structure with Cloudflare Workers as the backend, Durable Objects for state management, Workers AI binding for LLM access, JWT authentication for security, and a responsive frontend with industry-standard SVG icons. Create the initial wrangler.toml configuration with proper bindings, set up package.json with necessary scripts, and establish the basic worker structure that can handle routing and serve static assets.

## Backend Implementation with Durable Objects and RAG

Implement the backend worker with a ChatRoom Durable Object that manages conversation history with message persistence, user preferences including theme settings, cost tracking for AI token usage, and analytics for total messages and tokens used. Create JWT authentication using HS256 with a verifyJwtHS256 function that validates tokens and extracts the user identifier from the sub claim, protecting all API endpoints. Build the following API endpoints: POST /api/chat that calls Workers AI with Llama 3.3 70B and includes RAG integration using Vectorize, GET /api/history to retrieve conversation history, POST /api/clear to clear conversation history, POST /api/search to search through conversations, POST /api/preferences to update user preferences, GET /api/export to export conversation data as JSON, GET /api/health for health checks, and POST /api/embed-docs for uploading documentation embeddings to Vectorize. Implement error handling with retry logic for AI calls using three retries with exponential backoff, add proper CORS headers to all responses, and create a system prompt that strictly enforces answering only Cloudflare Agents SDK questions while politely refusing unrelated queries. For the RAG implementation, set up Vectorize binding in wrangler.toml with an index called cloudflare-agents-docs using 768 dimensions and cosine similarity, create a documentation ingestion process that chunks text into manageable segments and generates embeddings using the @cf/baai/bge-base-en-v1.5 model, and integrate RAG into the chat flow so that each user query generates an embedding, queries Vectorize for the top three most relevant documentation chunks, and injects that context into the system prompt for accurate, source-based answers. Ensure the RAG process fails gracefully if Vectorize is unavailable.

## Frontend Development and UI Polish

Create a modern, professional frontend with CSS custom properties for theming that enables instant switching between light and dark modes without transitions on theme-sensitive properties. Use Cloudflare orange (#f6821f) as the primary color throughout the interface, implement a fixed header with action buttons, an info bar with documentation link, a scrollable chat area that properly changes background in both themes, and a fixed input area at the bottom. Design a professional theme toggle switch with a slider and sun/moon icon, use industry-standard SVG icons throughout for search, usage tracking, export, clear, voice input, and send actions. For chat messages, style user messages with an orange gradient background and right alignment, assistant messages with white or dark background and a 2px orange border with left alignment, include avatar circles with user and AI labels, add a copy button that appears on hover, and implement markdown parsing for bold text, lists, links, and code blocks. Add subtle animations including message slide-in effects, button hover effects with elevation, a typing indicator that appears in the chat flow below the current message, toast notifications for user feedback, and modals with backdrop blur. Build custom modals for search conversations, usage and cost tracking with stat cards, and a clear confirmation dialog that replaces browser alerts. Implement voice input with Web Speech API integration that shows a pulsing red animation when listening and displays toast notifications when active. Ensure the entire viewport from edge to edge properly changes background color when switching themes, make the design responsive for mobile and desktop viewports, and ensure proper accessibility with keyboard navigation support and high contrast ratios in both themes.

## Code Organization and Final Optimization

After building the core functionality, refactor the codebase to be modular by splitting the frontend into separate HTML, CSS, and JavaScript files where styles.css contains all styles with unused variables removed, app.js has all the JavaScript logic, and index.html maintains a clean structure. For the backend, organize worker.js as the entry point with routing logic, handlers.js with all API route handlers, chat-room.js as the Durable Object class, auth.js for JWT verification, and utils.js for helper functions. Perform a final cleanup pass by removing all unnecessary comments, cleaning up unused CSS variables, ensuring consistent code formatting, adding a custom favicon with Cloudflare orange gradient, verifying all animations work smoothly, validating error handling is solid, confirming cost tracking is accurate, implementing storage limits to prevent overflow with automatic cleanup of old messages and cost entries, adding input validation for message length and type checking, and ensuring the application is production-ready with proper security configurations and comprehensive documentation.
